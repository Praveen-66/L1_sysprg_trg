# Makefile
#  Generated by the genmk.sh utility.

ALL := sig1 zombies_clear_traditional zombies_clear_linux26 \
	handle_segv nano sigcrit sanodef killer sigfd_man_eg

CC=${CROSS_COMPILE}gcc
CL=${CROSS_COMPILE}clang

CFLAGS=-Wall
CFLAGS_DBG=-g -ggdb -gdwarf-4 -O0 -Wall -Wextra
CFLAGS_DBG_ASAN= -fsanitize=address
CFLAGS_DBG_UB= -fsanitize=undefined

all: ${ALL}
CB_FILES := *.[ch]


common.o: ../common.c ../common.h
	${CC} ${CFLAGS} -c ../common.c -o common.o
common_dbg.o: ../common.c ../common.h
	${CC} ${CFLAGS_DBG} -c ../common.c -o common_dbg.o


sig1: common.o sig1.o
	${CC} ${CFLAGS} -o sig1 sig1.c common.o
sig1_dbg.o: sig1.c
	${CC} ${CFLAGS_DBG} -c sig1.c -o sig1_dbg.o
sig1_dbg: sig1_dbg.o common_dbg.o
	${CC} -o sig1_dbg sig1_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o sig1_asan sig1_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o sig1_ub sig1_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o sig1_msan sig1_dbg.o common_dbg.o


zombies_clear_traditional: common.o zombies_clear_traditional.o
	${CC} ${CFLAGS} -o zombies_clear_traditional zombies_clear_traditional.c common.o
zombies_clear_traditional_dbg.o: zombies_clear_traditional.c
	${CC} ${CFLAGS_DBG} -c zombies_clear_traditional.c -o zombies_clear_traditional_dbg.o
zombies_clear_traditional_dbg: zombies_clear_traditional_dbg.o common_dbg.o
	${CC} -o zombies_clear_traditional_dbg zombies_clear_traditional_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o zombies_clear_traditional_asan zombies_clear_traditional_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o zombies_clear_traditional_ub zombies_clear_traditional_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o zombies_clear_traditional_msan zombies_clear_traditional_dbg.o common_dbg.o

zombies_clear_linux26: common.o zombies_clear_linux26.o
	${CC} ${CFLAGS} -o zombies_clear_linux26 zombies_clear_linux26.c common.o
zombies_clear_linux26_dbg.o: zombies_clear_linux26.c
	${CC} ${CFLAGS_DBG} -c zombies_clear_linux26.c -o zombies_clear_linux26_dbg.o
zombies_clear_linux26_dbg: zombies_clear_linux26_dbg.o common_dbg.o
	${CC} -o zombies_clear_linux26_dbg zombies_clear_linux26_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o zombies_clear_linux26_asan zombies_clear_linux26_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o zombies_clear_linux26_ub zombies_clear_linux26_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o zombies_clear_linux26_msan zombies_clear_linux26_dbg.o common_dbg.o

handle_segv: common.o handle_segv.o
	${CC} ${CFLAGS} -o handle_segv handle_segv.c common.o
handle_segv_dbg.o: handle_segv.c
	${CC} ${CFLAGS_DBG} -c handle_segv.c -o handle_segv_dbg.o
handle_segv_dbg: handle_segv_dbg.o common_dbg.o
	${CC} -o handle_segv_dbg handle_segv_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o handle_segv_asan handle_segv_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o handle_segv_ub handle_segv_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o handle_segv_msan handle_segv_dbg.o common_dbg.o

nano: common.o nano.o
	${CC} ${CFLAGS} -o nano nano.c common.o
nano_dbg.o: nano.c
	${CC} ${CFLAGS_DBG} -c nano.c -o nano_dbg.o
nano_dbg: nano_dbg.o common_dbg.o
	${CC} -o nano_dbg nano_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o nano_asan nano_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o nano_ub nano_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o nano_msan nano_dbg.o common_dbg.o


sigcrit: common.o sigcrit.o
	${CC} ${CFLAGS} -o sigcrit sigcrit.c common.o
sigcrit_dbg.o: sigcrit.c
	${CC} ${CFLAGS_DBG} -c sigcrit.c -o sigcrit_dbg.o
sigcrit_dbg: sigcrit_dbg.o common_dbg.o
	${CC} -o sigcrit_dbg sigcrit_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o sigcrit_asan sigcrit_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o sigcrit_ub sigcrit_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o sigcrit_msan sigcrit_dbg.o common_dbg.o


sanodef: common.o sanodef.o
	${CC} ${CFLAGS} -o sanodef sanodef.c common.o
sanodef_dbg.o: sanodef.c
	${CC} ${CFLAGS_DBG} -c sanodef.c -o sanodef_dbg.o
sanodef_dbg: sanodef_dbg.o common_dbg.o
	${CC} -o sanodef_dbg sanodef_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o sanodef_asan sanodef_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o sanodef_ub sanodef_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o sanodef_msan sanodef_dbg.o common_dbg.o


killer: common.o killer.o
	${CC} ${CFLAGS} -o killer killer.c common.o
killer_dbg.o: killer.c
	${CC} ${CFLAGS_DBG} -c killer.c -o killer_dbg.o
killer_dbg: killer_dbg.o common_dbg.o
	${CC} -o killer_dbg killer_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o killer_asan killer_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o killer_ub killer_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o killer_msan killer_dbg.o common_dbg.o


sigfd_man_eg: common.o sigfd_man_eg.o
	${CC} ${CFLAGS} -o sigfd_man_eg sigfd_man_eg.c common.o
sigfd_man_eg_dbg.o: sigfd_man_eg.c
	${CC} ${CFLAGS_DBG} -c sigfd_man_eg.c -o sigfd_man_eg_dbg.o
sigfd_man_eg_dbg: sigfd_man_eg_dbg.o common_dbg.o
	${CC} -o sigfd_man_eg_dbg sigfd_man_eg_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_ASAN} -o sigfd_man_eg_asan sigfd_man_eg_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_UB} -o sigfd_man_eg_ub sigfd_man_eg_dbg.o common_dbg.o
	${CL} ${CFLAGS_DBG_MSAN} -o sigfd_man_eg_msan sigfd_man_eg_dbg.o common_dbg.o

# indent- "beautifies" C code into the "Linux kernel style".
# (cb = C Beautifier :) )
# Note! original source file(s) is overwritten, so we back it up.
cb: ${CB_FILES}
	mkdir bkp 2> /dev/null; cp -f ${CB_FILES} bkp/
	indent -linux ${CB_FILES}

clean:
	rm -vf ${ALL} core* vgcore* *.o *~
